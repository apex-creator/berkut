<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>xWRL6432 MMWAVE-L-SDK: Secondary Boot Loader</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="xWRL6432 MMWAVE-L-SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">xWRL6432 MMWAVE-L-SDK
   &#160;<span id="projectnumber">05.05.04.02</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EXAMPLES_DRIVERS_SBL.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Secondary Boot Loader </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md785">Introduction</a></li>
<li class="level1"><a href="#EXAMPLES_DRIVERS_SBL_COMBOS">Supported Combinations</a></li>
<li class="level1"><a href="#autotoc_md786">Using SDK with SysConfig</a></li>
<li class="level1"><a href="#autotoc_md787">Steps to Load the SBL Example</a></li>
<li class="level1"><a href="#autotoc_md788">Steps to use SBL Example</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_drivers_sbl"></a></p>
<h1><a class="anchor" id="autotoc_md785"></a>
Introduction</h1>
<p>This example demonstrates a Secondary Boot Loader (SBL). The SBL primarily is responsible for updating the application metaimage in the SFLASH by receiving the image over a serial interface. It then loads and runs the updated application meta image. The RBL (ROM bootloader) always loads the SBL. Application can choose to either update or load and run the application meta image. The SBL will ensure the factory default backup image is never erased or updated by the image updater. The upgrade is done for the entire meta image. The SBL performs the checksum verification to verify the validity of the meta image it is trying to load from SFLASH. In the case where the image is corrupted or download is interrupted, factory default backup image will be loaded. This example aims at providing a reference design to fulfill the above requirement.</p>
<h1><a class="anchor" id="EXAMPLES_DRIVERS_SBL_COMBOS"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU + OS  </td><td class="markdownTableBodyNone">m4fss0-0 nortos   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">ti-arm-clang   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Boards  </td><td class="markdownTableBodyNone">xWRL6432-evm   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/drivers/boot/sbl   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md786"></a>
Using SDK with SysConfig</h1>
<p>A GUI tool SysConfig is used to configure different modules and peripherals of the example. Using this tool, users can select and customize different modules and peripherals. The SysConfig tool will generate the code for initializing and configuring these modules. This configuration is saved to a file called example.syscfg for every example. To know more about how to use SDK with SysConfig, Visit this page</p>
<p><a class="el" href="SYSCONFIG_INTRO_PAGE.html">Using SDK with SysConfig</a></p>
<h1><a class="anchor" id="autotoc_md787"></a>
Steps to Load the SBL Example</h1>
<ul>
<li><b>When using CCS projects to build</b>, import the CCS project for the required combination and build it using the CCS project menu (see <a class="el" href="CCS_PROJECTS_PAGE.html">Using SDK with CCS Projects</a>).</li>
<li><b>When using makefiles to build</b>, note the required combination and build using make command (see <a class="el" href="MAKEFILE_BUILD_PAGE.html">Using SDK with Makefiles</a>).</li>
<li><b>Important Notes:</b> <ul>
<li>
As SBL is designed to run from APPSS-HWASS 256KB shared memory, following configurations are needed prior to running SBL. </li>
<li>
If we want SBL to run from flash in functional mode, SBL (sbl.xxx.appimage) can be flashed using visualizer tool (<a class="el" href="TOOLS_VISUALIZER.html">Visualizer Tool</a>) or UniFlash tool </li>
<li>
If we want to use CCS to run SBL as per <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a>, following changes have to be made in empty project and empty project has to be rebuilt before using it: <br  />
<ul>
<li>Modify "SH_MEM_CONFIG" to "0x3" in "makefile" and "makefile_ccs_bootimage_gen" files of empty project.</li>
<li>Ensure the MPU configuration in Sys config of empty project for RAM is of 1MB size. </li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md788"></a>
Steps to use SBL Example</h1>
<ul>
<li>
SBL assumes flash partitions as below:  <style>div.image img[src="sbl_mem.png"]{width:40%}</style> <div class="image">
<img src="sbl_mem.png" alt=""/>
</div>
 </li>
<li>
Uniflash tool can be used to load both SBL (at Partition 1) as well as factory default image (at Partition 4) to flash. Load the images to flash as given below:<ul>
<li>First Load the SBL appimage at partition 1  <style>div.image img[src="SBL_pic1.png"]{width:60%}</style> <div class="image">
<img src="SBL_pic1.png" alt=""/>
</div>
 <br  />
</li>
<li>After Loading the image, Reset the device. <br  />
</li>
<li>Load the factory default image at Partition 4  <style>div.image img[src="SBLpic2.png"]{width:60%}</style> <div class="image">
<img src="SBLpic2.png" alt=""/>
</div>
  </li>
</ul>
</li>
<li>
Connect to the COM port (shows as “XDS110 Class Application/User UART” under device manager) using Tera Term and configure the port with the configuration as shown below.  <style>div.image img[src="sbl_cfg.png"]{width:60%}</style> <div class="image">
<img src="sbl_cfg.png" alt=""/>
</div>
 </li>
<li>
Reset the target by pressing the "RESET_SW" button on the evaluation board.  </li>
<li>
SBL waits for preconfigured time (by default 10sec) for input (either "Enter" or "Space"from the user). If there is no "Enter" or "Space" button press from the user with-in the pre-defined time (by default 10sec), the SBL checks if there is valid image in partition 2. If there is a valid image, that image is loaded. If the image in partition 2 is invalid, factory default image at partition 4 is loaded. If user inputs either "Enter" or "Space", SBL will start loading via UART interface. </li>
<li>
SBL will print the following message, prompting the user to press any key to stop the autoboot process and load a new application meta image over UART. If user wants to perform loading, user is expected to input either "Enter" or "Space" button.  <style>div.image img[src="sbl_start.png"]{width:60%}</style> <div class="image">
<img src="sbl_start.png" alt=""/>
</div>
 </li>
<li>
When there is a valid input from user to stop the autoboot process, SBL will erase flash partition and will be waiting for application image over UART.  <style>div.image img[src="sbl_loading1.png"]{width:60%}</style> <div class="image">
<img src="sbl_loading1.png" alt=""/>
</div>
 </li>
<li>
Start the file download using XMODEM via the Teraterm. <dl class="section note"><dt>Note</dt><dd>: SBL supports incoming data in 1KB chunks only. Hence, Make sure 1k checkbox is checked. If this is not checked, file will not get downloaded via XMODEM.  <style>div.image img[src="sbl_loading2.png"]{width:60%}</style> <div class="image">
<img src="sbl_loading2.png" alt=""/>
</div>
  <style>div.image img[src="sbl_loading3.png"]{width:60%}</style> <div class="image">
<img src="sbl_loading3.png" alt=""/>
</div>
 </dd></dl>
</li>
<li>
Once the image is downloaded, SBL verifies the image and loads from SFLASH to RAM. Example: Loaded "hello world" example.  <style>div.image img[src="sbl_loading4.png"]{width:60%}</style> <div class="image">
<img src="sbl_loading4.png" alt=""/>
</div>
 </li>
<li>
If download of application image fails, SBL boots the factory default image as application image is erased before loading.  <style>div.image img[src="sbl_loading5.png"]{width:60%}</style> <div class="image">
<img src="sbl_loading5.png" alt=""/>
</div>
 </li>
<li>
If, user decides not to do any loading, image at application image partition is booted.  <style>div.image img[src="sbl_booting1.png"]{width:60%}</style> <div class="image">
<img src="sbl_booting1.png" alt=""/>
</div>
 </li>
<li>
If, image at application image partition is invalid, factory default image is booted.  <style>div.image img[src="sbl_booting2.png"]{width:60%}</style> <div class="image">
<img src="sbl_booting2.png" alt=""/>
</div>
 </li>
<li>
<b>Developer Notes</b><ul>
<li>BSS, Data, Stack and Heap sections of SBL are configured to last 64KB of normal RAM (from address 0x00470000 to 0x0047FFFF) because of "Errata DIG#14: Corrupted Data Store for Partial Write in Shared Memory." Workaround for this was to use shared memory as read only memory or disable ECC for APPSS/HWASS memory when shared with APPSS (M4).</li>
<li>If SBL example is being used, application being loaded cannot use Shared RAM for text, data, Read Only sections. Also, as SBL uses 64KB of RAM from address 0x00470000, application should avoid this area as well. <br  />
</li>
<li>The App image being loaded cannot use eclipse mode in its application.</li>
<li>This SBL reference design supports maximum application image size of 512 KB. Users can increase this limit according to their SBL design.</li>
<li>The timeout for stopping auto boot is configurable in sbl.h</li>
<li>The maximum number of times the xmodem will attempt to establish a transfer is configurable in transport.h  </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
