<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>xWRL6432 MMWAVE-L-SDK: Cfarproc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="xWRL6432 MMWAVE-L-SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">xWRL6432 MMWAVE-L-SDK
   &#160;<span id="projectnumber">05.05.04.02</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('CFARPROC_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Cfarproc </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md542">Introduction</a></li>
<li class="level1"><a href="#autotoc_md543">CFAR DPU when the input is range-azimuth detection matrix</a><ul><li class="level2"><a href="#autotoc_md544">Block Diagram</a></li>
<li class="level2"><a href="#autotoc_md545">CFAR DPU Functioning</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md546">CFAR DPU when the input is range-doppler detection matrix</a><ul><li class="level2"><a href="#autotoc_md547">Block Diagram</a></li>
<li class="level2"><a href="#autotoc_md548">CFAR DPU Functioning</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md549">CFAR CLI Command</a></li>
<li class="level1"><a href="#autotoc_md550">Usage Overview</a><ul><li class="level2"><a href="#autotoc_md551">API</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md552">Example Usage</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_datapath_cfarproc"></a></p>
<h1><a class="anchor" id="autotoc_md542"></a>
Introduction</h1>
<p>The CFAR DPU is updated in the latest SDK release by introducing support for an additional input detection matrix type, the range-doppler detection matrix. This new addition complements the existing input rangeazimuth detection matrix type.</p>
<h1><a class="anchor" id="autotoc_md543"></a>
CFAR DPU when the input is range-azimuth detection matrix</h1>
<p>The CFAR DPU performs peak detection algorithm applied on the range-azimuth heatmap created by DOA DPU. The detection process is split into two stages. In the first stage, executed on HWA, a CFAR detection algorithm is applied to the range-azimuth heatmap. The output of CFAR detection is the intermediate list of detected points. Each point in the intermediate list is defined by the three-element structure including the range index (rngInd), the azimuth index (azInd) and the CFAR cell average noise (cfarCellNoise). The HWA also computes the array of maxima along the azimuth dimension, for each range index. This array is used in the second stage, in the post detection peak processing. It is also optionally sent to the Host as a visual representation of the range profile. In the second stage processing, performed by CPU, the final point cloud list is created.</p>
<h2><a class="anchor" id="autotoc_md544"></a>
Block Diagram</h2>
<p>The top-level block diagram of the DPU is shown in the figure below.</p>
<p> <style>div.image img[src="cfarproc_range_azi.png"]{width:80%}</style> </p><div class="image">
<img src="cfarproc_range_azi.png" alt=""/>
<div class="caption">
CFAR DPU top-level diagram</div></div>
<p>The CFAR processing detailed block diagram is shown below.</p>
<p> <style>div.image img[src="cfarproc_range_azi_dataflow.png"]{width:80%}</style> </p><div class="image">
<img src="cfarproc_range_azi_dataflow.png" alt=""/>
<div class="caption">
CFAR DPU block diagram</div></div>
<p>Post detection peak processing is shown below</p>
<p> <style>div.image img[src="cfarproc_range_azi_state_machine.png"]{width:40%}</style> </p><div class="image">
<img src="cfarproc_range_azi_state_machine.png" alt=""/>
<div class="caption">
Post detection peak processing</div></div>
<h2><a class="anchor" id="autotoc_md545"></a>
CFAR DPU Functioning</h2>
<p>The processing flow is per detected point from the intermediate detection list, CFAR output list. If the detected peak satisfies all detection criteria it is placed in the final point cloud list. The following criteria must be satisfied:</p><ul>
<li><b>Peak falls inside a region of interest</b>: Each detected point is check to see if it falls in the region of interest specified by the CLI FOV commands. The boundaries of the region of interest in range, azimuth and elevation direction converted to indices are denoted as in the flow diagram as:<ul>
<li>rMin â€“ minimum index in range dimension</li>
<li>rMax â€“ maximum index in range dimension</li>
<li>aMin â€“ minimum index in azimuth dimension</li>
<li>aMax â€“ maximum index in azimuth dimension</li>
<li>eMin â€“ minimum index in elevation dimension</li>
<li>eMax â€“ maximum index in elevation dimension</li>
</ul>
</li>
<li><b>Peak is local in range dimension</b>: If this option is enabled in the cfarCfg command, the algorithm checks to see if the peak is a local peak in the range dimension: ğ‘‹<sub>ğ‘˜âˆ’1,ğ‘—</sub> â‰¤ ğ‘‹<sub>ğ‘˜,ğ‘—</sub> â‰¤ ğ‘‹<sub>ğ‘˜+1,ğ‘—</sub> (where ğ‘˜ is range index of detected peak).</li>
<li><b>Peak is local in azimuth dimension</b>: If this option is enabled in the cfarCfg command, the algorithm checks to see if the peak is a local peak in the azimuth dimension: ğ‘‹<sub>ğ‘˜,ğ‘—âˆ’1</sub> â‰¤ ğ‘‹<sub>ğ‘˜,ğ‘—</sub> â‰¤ ğ‘‹<sub>ğ‘˜,ğ‘—+1</sub> (where ğ‘— is azimuth index of detected peak).</li>
<li><b>Peak is equal or greater than the side lobe threshold</b>: The peak is checked against the side lobe threshold, ğ‘‡ğ‘˜. The side lobe threshold is calculated for each range index value, as a maximum along the azimuth dimension multiplied with a fixed threshold scale. The maximum per range index, (also called as a range profile), is calculate by HWA (see Figure 12). The threshold scale, (0 to 1), is provided by the CLI cfarCfg command. The condition is: ğ‘‹<sub>ğ‘˜,ğ‘—</sub>â‰¥ğ‘‡<sub>ğ‘˜</sub></li>
</ul>
<p>Once all of these criteria are satisfied the further processing includes the following calculations.</p>
<ul>
<li><b>Peak position interpolation in range dimension</b>: If the checking option is enabled in the cfarCfg command, the peak range index is corrected by fractional correction term ğ›¿<sub>ğ‘Ÿ</sub>. The interpolation formula to calculate ğ›¿<sub>ğ‘Ÿ</sub> is given by<ul>
<li>ğ›¿<sub>ğ‘Ÿ</sub> = ğ‘ƒ(|ğ‘‹<sub>ğ‘˜+1</sub>|âˆ’|ğ‘‹<sub>ğ‘˜âˆ’1</sub>|) / (|ğ‘‹<sub>ğ‘˜</sub>|+|ğ‘‹<sub>ğ‘˜+1</sub>|+|ğ‘‹<sub>ğ‘˜âˆ’1</sub>|) (where ğ‘ƒ=1.75)</li>
<li>The range peak index ğ‘˜, is then corrected as: ğ‘˜<sub>ğ‘ğ‘’ğ‘ğ‘˜</sub> = ğ‘˜+ğ›¿<sub>ğ‘Ÿ</sub></li>
<li>The range estimate, ğ‘Ÿ, in meters is calculated as: ğ‘Ÿ = ğ‘˜<sub>ğ‘ğ‘’ğ‘ğ‘˜</sub>âˆ™ğ‘Ÿ<sub>ğ‘ ğ‘¡ğ‘’ğ‘</sub> where ğ‘Ÿ<sub>ğ‘ ğ‘¡ğ‘’ğ‘</sub> is range bin to meter conversion ğ‘Ÿ<sub>ğ‘ ğ‘¡ğ‘’ğ‘</sub> = ğ‘âˆ™ğ¹<sub>ğ‘†ğ‘ğ‘šğ‘</sub> / 2âˆ™ğ‘†âˆ™ğ‘<sub>ğ´ğ·ğ¶</sub> (where ğ‘ is speed of light, ğ¹<sub>ğ‘†ğ‘ğ‘šğ‘</sub> is sampling frequency, ğ‘† is chirp frequency slope, and ğ‘<sub>ğ´ğ·ğ¶</sub> is number of ADC samples).</li>
</ul>
</li>
<li><b>Peak position interpolation in azimuth dimension</b>: If the checking option is enabled in azimuth dimension, the peak azimuth index is corrected by fractional correction term ğ›¿<sub>ğ‘</sub>. The interpolation formula to calculate ğ›¿<sub>ğ‘</sub> is given by<ul>
<li>ğ›¿<sub>ğ‘</sub> = (|ğ‘‹<sub>ğ‘˜+1</sub>|âˆ’|ğ‘‹<sub>ğ‘˜âˆ’1</sub>|)(4|ğ‘‹<sub>ğ‘˜</sub>|âˆ’2|ğ‘‹<sub>ğ‘˜+1</sub>|âˆ’2|ğ‘‹<sub>ğ‘˜âˆ’1</sub>|)</li>
<li>The azimuth peak index ğ‘—, (previously converted to signed value), is corrected as: ğ‘—<sub>ğ‘ğ‘’ğ‘ğ‘˜</sub> = ğ‘—+ğ›¿<sub>ğ‘</sub></li>
</ul>
</li>
<li><b>Calculation of X,Y,Z coordinates</b>: The symbol phase increment between successive elements of antenna array in ğ‘¥ dimension is given by ğ‘Š<sub>ğ‘¥</sub> = ğœ†âˆ™ğ‘—<sub>ğ‘ğ‘’ğ‘ğ‘˜</sub> / d.ğ‘ğ¹ğ¹ğ‘‡ğ‘ğ‘§ğ‘–ğ‘š, where ğ‘‘ is the distance between successive elements of the virtual antenna array and ğ‘<sub>ğ¹ğ¹ğ‘‡ğ‘ğ‘§ğ‘–ğ‘š</sub> is azimuth FFT size.<ul>
<li>The ğ‘¥ coordinate is calculated as ğ‘¥ = ğ‘Ÿâˆ™ğ‘Š<sub>ğ‘¥</sub></li>
<li>The symbol phase increment between successive elements of antenna array in ğ‘§ dimension is given by ğ‘Š<sub>ğ‘§</sub> = âˆ’ğœ†âˆ™ğ‘™<sub>ğ‘ğ‘’ğ‘ğ‘˜</sub> / ğ‘‘âˆ™ğ‘<sub>ğ¹ğ¹ğ‘‡ğ‘’ğ‘™ğ‘’ğ‘£</sub>, where ğ‘™<sub>ğ‘ğ‘’ğ‘ğ‘˜</sub> is elevation index (converted to signed value) of the peak and ğ‘<sub>ğ¹ğ¹ğ‘‡ğ‘’ğ‘™ğ‘’ğ‘£</sub> is elevation FFT size.</li>
<li>The ğ‘§ coordinate is calculated as ğ‘§ = ğ‘Ÿâˆ™ğ‘Š<sub>ğ‘§</sub></li>
<li>The ğ‘¦ coordinate is calculated as  <style>div.image img[src="cfarproc_azi_eq1.png"]{width:30%}</style> <div class="image">
<img src="cfarproc_azi_eq1.png" alt=""/>
</div>
</li>
</ul>
</li>
<li><b>Calculation of radial velocity</b>: The radial velocity of the detected point is calculated as  <style>div.image img[src="cfarproc_azi_eq2.png"]{width:50%}</style> <div class="image">
<img src="cfarproc_azi_eq2.png" alt=""/>
</div>
 ğ‘–<sub>ğ‘‘ğ‘œğ‘ğ‘ğ‘™ğ‘’ğ‘Ÿ</sub> is the signed value of the detected point Doppler index taken from the Doppler index table.Positive velocity means that the target is moving away from the sensor and vice versa. In the case when the noncoherent Doppler summation mode is selected, the radial velocity is set to zero.</li>
<li><b> Calculation of noise and SNR:</b> The noise of the detected point is calculated from the CFAR cell side noise as ğ‘›ğ‘œğ‘–ğ‘ ğ‘’<sub>ğ‘‘ğµ</sub>=20log<sub>10</sub>(cfarCellNoise) and the snr is calculated as ğ‘ ğ‘›ğ‘Ÿ<sub>ğ‘‘ğµ</sub> = 20log<sub>10</sub>(ğ‘‹(ğ‘˜,ğ‘—)) âˆ’ ğ‘›ğ‘œğ‘–ğ‘ ğ‘’<sub>ğ‘‘ğµ</sub> where is ğ‘‹(ğ‘˜,ğ‘—) a peak value read out from the detection matrix. The noise and the and the snr are stored in the point cloud in uint16 format, where 1LSB =0.1dB.</li>
</ul>
<p>Each point in the CFAR output point cloud list is described by a structure below</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>DPIF_PointCloudCartesianExt_t</div>
<div class="line">{</div>
<div class="line"><span class="keywordtype">float</span> x; <span class="comment">/* x - coordinate in meters */</span></div>
<div class="line"><span class="keywordtype">float</span> y; <span class="comment">/* y - coordinate in meters */</span></div>
<div class="line"><span class="keywordtype">float</span> z; <span class="comment">/* z - coordinate in meters */</span></div>
<div class="line"><span class="keywordtype">float</span> velocity; <span class="comment">/* radial Doppler velocity in m/s */</span></div>
<div class="line"><span class="keywordtype">float</span> snr; <span class="comment">/* snr - CFAR cell to side noise ratio in dB */</span></div>
<div class="line"><span class="keywordtype">float</span> noise; <span class="comment">/* noise in dB */</span></div>
<div class="line">} DPIF_PointCloudCartesianExt;</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md546"></a>
CFAR DPU when the input is range-doppler detection matrix</h1>
<h2><a class="anchor" id="autotoc_md547"></a>
Block Diagram</h2>
<p>The top-level block diagram of the DPU is shown in the figure below.</p>
<p> <style>div.image img[src="cfarproc_range_dop.png"]{width:80%}</style> </p><div class="image">
<img src="cfarproc_range_dop.png" alt=""/>
<div class="caption">
CFAR DPU top-level diagram</div></div>
<p>The CFAR processing detailed block diagram is shown below.</p>
<p> <style>div.image img[src="cfarproc_range_dop_dataflow.png"]{width:80%}</style> </p><div class="image">
<img src="cfarproc_range_dop_dataflow.png" alt=""/>
<div class="caption">
CFAR DPU block diagram</div></div>
<p>Post detection peak processing is shown below</p>
<p> <style>div.image img[src="cfarproc_range_dop_state_machine.png"]{width:40%}</style> </p><div class="image">
<img src="cfarproc_range_dop_state_machine.png" alt=""/>
<div class="caption">
Post detection peak processing</div></div>
<h2><a class="anchor" id="autotoc_md548"></a>
CFAR DPU Functioning</h2>
<p>The processing flow is per detected point from the intermediate detection list, CFAR output list. If the detected peak satisfies all detection criteria it is placed in the final detection list. The following criteria must be satisfied:</p><ul>
<li><b>Peak falls inside a region of interest</b>: Each detected point is check to see if it falls in the region of interest specified by the CLI FOV commands. The boundaries of the region of interest in range, azimuth and elevation direction converted to indices are denoted as in the flow diagram as:<ul>
<li>rMin â€“ minimum index in range dimension</li>
<li>rMax â€“ maximum index in range dimension</li>
</ul>
</li>
<li><b>Peak is local in range dimension</b>: If this option is enabled in the cfarCfg command the algorithm checks to see if the peak is a local peak in the range dimension: ğ‘‹<sub>ğ‘˜âˆ’1,ğ‘—</sub> â‰¤ ğ‘‹<sub>ğ‘˜,ğ‘—</sub> â‰¤ ğ‘‹<sub>ğ‘˜+1,ğ‘—</sub> (where ğ‘˜ is range index of detected peak).</li>
<li><b>Peak is local in Doppler dimension</b>: If this option is enabled in the cfarCfg command, the algorithm checks to see if the peak is a local peak in the Doppler dimension: ğ‘‹<sub>ğ‘˜,ğ‘—âˆ’1</sub> â‰¤ ğ‘‹<sub>ğ‘˜,ğ‘—</sub> â‰¤ ğ‘‹<sub>ğ‘˜,ğ‘—+1</sub> (where ğ‘— is doppler index of detected peak).</li>
<li><b>Peak position interpolation in range dimension:</b> If the checking option is enabled in the cfarCfg command, the peak range index is corrected by fractional correction term ğ›¿<sub>ğ‘Ÿ</sub>. The interpolation formula to calculate ğ›¿<sub>ğ‘Ÿ</sub> is given by:<ul>
<li>ğ›¿<sub>ğ‘Ÿ</sub> = ğ‘ƒ(|ğ‘‹<sub>ğ‘˜+1</sub>|âˆ’|ğ‘‹<sub>ğ‘˜âˆ’1</sub>|) / (|ğ‘‹<sub>ğ‘˜</sub>|+|ğ‘‹<sub>ğ‘˜+1</sub>|+|ğ‘‹<sub>ğ‘˜âˆ’1</sub>|) (where ğ‘ƒ=1.75)</li>
<li>The range peak index ğ‘˜, is then corrected as: ğ‘˜<sub>ğ‘ğ‘’ğ‘ğ‘˜</sub> = ğ‘˜+ğ›¿<sub>ğ‘Ÿ</sub></li>
<li>The range estimate, ğ‘Ÿ, in meters is calculated as: ğ‘Ÿ = ğ‘˜<sub>ğ‘ğ‘’ğ‘ğ‘˜</sub>âˆ™ğ‘Ÿ<sub>ğ‘ ğ‘¡ğ‘’ğ‘</sub> - ğ‘Ÿ<sub>ğµğ‘–ğ‘ğ‘ </sub> where ğ‘Ÿ<sub>ğ‘ ğ‘¡ğ‘’ğ‘</sub> is range bin to meter conversion ğ‘Ÿ<sub>ğ‘ ğ‘¡ğ‘’ğ‘</sub> = ğ‘âˆ™ğ¹<sub>ğ‘†ğ‘ğ‘šğ‘</sub> / 2âˆ™ğ‘†âˆ™ğ‘<sub>ğ´ğ·ğ¶</sub> (where ğ‘ is speed of light, ğ¹<sub>ğ‘†ğ‘ğ‘šğ‘</sub> is sampling frequency, ğ‘† is chirp frequency slope, ğ‘<sub>ğ´ğ·ğ¶</sub> is number of ADC samples and ğ‘Ÿ<sub>ğµğ‘–ğ‘ğ‘ </sub> is range bias provided by the CLI command compRangeBiasAndRxChanPhase).</li>
</ul>
</li>
<li><b>Peak position interpolation in doppler dimension</b>: If the checking option is enabled in Doppler dimension, the peak Doppler index is corrected by fractional correction term ğ›¿<sub>ğ‘‘</sub>. The interpolation formula to calculate ğ›¿<sub>ğ‘‘</sub> is given by<ul>
<li>ğ›¿<sub>ğ‘</sub>=(|ğ‘‹<sub>ğ‘˜+1</sub>|âˆ’|ğ‘‹<sub>ğ‘˜âˆ’1</sub>|)(4|ğ‘‹<sub>ğ‘˜</sub>|âˆ’2|ğ‘‹<sub>ğ‘˜+1</sub>|âˆ’2|ğ‘‹<sub>ğ‘˜âˆ’1</sub>|)</li>
<li>The Doppler peak index ğ‘–<sub>ğ‘‘ğ‘œğ‘ğ‘ğ‘™ğ‘’ğ‘Ÿ</sub>, (previously converted to signed value), is corrected as: ğ‘–â€²<sub>ğ‘‘ğ‘œğ‘ğ‘ğ‘™ğ‘’ğ‘Ÿ</sub> = ğ‘–<sub>ğ‘‘ğ‘œğ‘ğ‘ğ‘™ğ‘’ğ‘Ÿ</sub>+ğ›¿<sub>ğ‘</sub></li>
</ul>
</li>
<li><b>Calculation of radial velocity</b>: The radial velocity of the detected point is calculated as  <style>div.image img[src="cfarproc_dop_eq1.png"]{width:50%}</style> <div class="image">
<img src="cfarproc_dop_eq1.png" alt=""/>
</div>
 ğ‘–<sub>ğ‘‘ğ‘œğ‘ğ‘ğ‘™ğ‘’ğ‘Ÿ</sub> stored in the output list is the signed value of the detected point Doppler index. Positive velocity means that the target is moving away from the sensor and vice versa.</li>
<li><b> Calculation of noise and SNR:</b> The noise of the detected point is calculated from the CFAR cell side noise as ğ‘›ğ‘œğ‘–ğ‘ ğ‘’<sub>ğ‘‘ğµ</sub>=20log<sub>10</sub>(cfarCellNoise) and the snr is calculated as ğ‘ ğ‘›ğ‘Ÿ<sub>ğ‘‘ğµ</sub> = 20log<sub>10</sub>(ğ‘‹(ğ‘˜,ğ‘—)) âˆ’ ğ‘›ğ‘œğ‘–ğ‘ ğ‘’<sub>ğ‘‘ğµ</sub> where is ğ‘‹(ğ‘˜,ğ‘—) a peak value read out from the detection matrix.</li>
</ul>
<p>Each point in the CFAR output point cloud list is described by a structure below</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>DPIF_CFARRngDopDetListElement_t</div>
<div class="line">{</div>
<div class="line"><span class="keywordtype">float</span> range; </div>
<div class="line"><span class="keywordtype">float</span> doppler; </div>
<div class="line">uint16_t rangeIdx; </div>
<div class="line">int16_t dopplerIdx; </div>
<div class="line"><span class="keywordtype">float</span> snrdB; </div>
<div class="line"><span class="keywordtype">float</span> noisedB; </div>
<div class="line">} DPIF_CFARRngDopDetListElement;</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md549"></a>
CFAR CLI Command</h1>
<p>Since the CFAR DPU is updated to support processing on the range-doppler heatmap in addition to range-azimuth heatmap, the interpretation of some parameters in the CLI command varies depending on the operation mode. In the range-doppler mode, these parameters are associated with Doppler dimension, whereas in the range-azimuth mode, they pertain to the azimuth dimension as described in Table below. Note that the side lobe threshold is applicable only to azimuth in both dimensions but, used in different DPUs.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter original name  </th><th class="markdownTableHeadLeft">Range-Azimuth Input mode  </th><th class="markdownTableHeadNone">Range-Doppler Input mode   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">sideLobeThreshold  </td><td class="markdownTableBodyLeft">Used in CFAR DPU, applied in azimuth domain  </td><td class="markdownTableBodyNone">Used in AoA2D DPU, applied in azimuth domain   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">localMaxAzimuthDomain  </td><td class="markdownTableBodyLeft">Pertain to azimuth dimension  </td><td class="markdownTableBodyNone">Pertain to Doppler dimension   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">interpolateAzimuthDomain  </td><td class="markdownTableBodyLeft">Pertain to azimuth dimension  </td><td class="markdownTableBodyNone">Pertain to Doppler dimension   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md550"></a>
Usage Overview</h1>
<h2><a class="anchor" id="autotoc_md551"></a>
API</h2>
<p>The CFAR DPU detection APIs are listed below.</p>
<ul>
<li><a class="el" href="cfarprochwa_8h.html#a207bba02593a343aea16e041d90c44a5">DPU_CFARProcHWA_init()</a>: This function allocates memory for the CFAR DPU instance and initializes it to zero. It also constructs the semaphores used for processing.</li>
<li><a class="el" href="cfarprochwa_8h.html#ac6a6b381612669031d19013e3daca97b">DPU_CFARProcHWA_config()</a>: Based on the configuration parameters, this function configures hardware accelerator CFAR engine and the input and output EDMA channels to bring detection matrix in HWA memory, and take out range profile array. The function is normally called one time before the sensor start command is issued to the RF. In the low power deep sleep mode, the function is called per frame. The DPU mode of operation is determined by the parameter detectionHeatmapType, within the input configuration structure. This parameter determines the type of the input detection matrix, whether it is range-doppler or range-azimuth, as well as the type of postprocessing after the CFAR operation. Thus this parameter determines the mode of operation of the CFAR DPU, as shown in Table below. <pre class="fragment">| detectionHeatmapType          | CFAR mode of operation                  
|-------------------------------|:-----------------------|
|DPU_CFAR_RANGE_AZIMUTH_HEATMAP | range-azimuth mode     |    
|DPU_CFAR_RANGE_DOPPLER_HEATMAP |range-doppler mode      | 
</pre></li>
<li><p class="startli"><a class="el" href="cfarprochwa_8h.html#ae9e42d4dbc3ca277bb6adcf7bb538eb8">DPU_CFARProcHWA_process()</a>: This description This function is called per frame after</p><ul>
<li>the DOA DPU is completed in in range-azimuth mode, or</li>
<li>the Doppler DPU is completed in range-doppler mode.</li>
</ul>
<p class="startli">The output arguments to the function are</p><ul>
<li>pointer to the range profile array,</li>
<li>pointer to the output detection list:<ul>
<li>the final point-cloud list, in range-azimuth mode, or</li>
<li>the range-doppler detection list.</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre class="fragment">The function performs the following steps:
- configures the source address of the input EDMA parameter,
- configures destination address of the output EDMA parameter,
- configures the common registers of the HWA, such as start and end param set, and the number of loops,
- triggers the input EDMA,
- pends on the semaphores for the end of the processing as the entire chain processing is performed by HWA.
- Performs the post detection processing by calling function:
    - CFAR_DET_HWA_cfarRange_ProcList(), in range-azimuth mode, or
    - CFAR_DET_HWA_cfarRangeDoppler_ProcList() in range-doppler mode.
</pre><ul>
<li><a class="el" href="cfarprochwa_8h.html#a5fce50280d5913fc9d7882e9cbce7382">DPU_CFARProcHWA_control()</a>: This function is currently empty.</li>
<li><a class="el" href="cfarprochwa_8h.html#a4b2c007a54e46ad583cecdc4d58ab5b8">DPU_CFARProcHWA_deinit()</a>: It frees the resources used for the DPU.</li>
<li><a class="el" href="cfarprochwa_8h.html#a3dead8130016fd6e335724e47e3e4e19">DPU_CFARProcHWA_GetNumUsedHwaParamSets()</a>: It returns the number of param sets allocated during the configuration time. It is called after the function <a class="el" href="cfarprochwa_8h.html#ac6a6b381612669031d19013e3daca97b">DPU_CFARProcHWA_config()</a> has been called.</li>
</ul>
<h1><a class="anchor" id="autotoc_md552"></a>
Example Usage</h1>
<p>Include the below file to access the APIs </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cfarprochwa_8h.html">datapath/dpu/cfarproc/v0/cfarprochwa.h</a>&gt;</span></div>
</div><!-- fragment --><p> DPU Initialization Example </p><div class="fragment"><div class="line">    <a class="code" href="structDPU__CFARProcHWA__InitParams.html">DPU_CFARProcHWA_InitParams</a> initParams;</div>
<div class="line">    initParams.<a class="code" href="structDPU__CFARProcHWA__InitParams.html#a9c8fbcbe522ade6a009197984a7b3eec">hwaHandle</a> =  hwaHandle;</div>
<div class="line">    <span class="comment">/* generate the dpu handler*/</span></div>
<div class="line">    cfarProcDpuHandle =  <a class="code" href="cfarprochwa_8h.html#a207bba02593a343aea16e041d90c44a5">DPU_CFARProcHWA_init</a>(&amp;initParams, &amp;errorCode);</div>
<div class="line">    <span class="keywordflow">if</span> (cfarProcDpuHandle == NULL)</div>
<div class="line">    {</div>
<div class="line">        CLI_write (<span class="stringliteral">&quot;Error: CFAR Proc DPU initialization returned error %d\n&quot;</span>, errorCode);</div>
<div class="line">        <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a> (0);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> DPU Configuration Parsing Example </p><div class="fragment"><div class="line">    pHwConfig = &amp;cfarProcDpuCfg.res;</div>
<div class="line">    params = &amp;cfarProcDpuCfg.staticCfg;</div>
<div class="line"> </div>
<div class="line">    memset((<span class="keywordtype">void</span> *)&amp;cfarProcDpuCfg, 0, <span class="keyword">sizeof</span>(<a class="code" href="structDPU__CFARProcHWA__Config.html">DPU_CFARProcHWA_Config</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* HWA configurations, not related to per test, common to all test */</span></div>
<div class="line">    pHwConfig-&gt;hwaCfg.paramSetStartIdx = <a class="code" href="doaproc_8h.html#a89ef7b614cfeae7e2b335f9af5d8f649">DPU_DOAPROC_MAX_NUM_HWA_PARAMSET</a> + <a class="code" href="rangeprochwa_8h.html#ac725afeda9232deb7624d60a48309e9d">DPU_RANGEPROCHWA_NUM_HWA_PARAM_SETS</a>;</div>
<div class="line">    pHwConfig-&gt;hwaCfg.numParamSet = <a class="code" href="cfarprochwa_8h.html#a6972d9ab611bb1abac276a194d15fc72">DPU_CFARPROCHWA_MAX_NUM_HWA_PARAMSET</a>;</div>
<div class="line">    pHwConfig-&gt;hwaCfg.dmaTrigSrcChan = DPC_ObjDet_HwaDmaTrigSrcChanPoolAlloc(&amp;gMmwMssMCB.HwaDmaChanPoolObj);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* edma configuration */</span></div>
<div class="line">    pHwConfig-&gt;edmaHandle  = gEdmaHandle[0];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Data Input EDMA */</span></div>
<div class="line">    pHwConfig-&gt;edmaHwaIn.channel         = DPC_OBJDET_DPU_CFAR_PROC_EDMAIN_CH;</div>
<div class="line">    pHwConfig-&gt;edmaHwaIn.channelShadow   = DPC_OBJDET_DPU_CFAR_PROC_EDMAIN_SHADOW;</div>
<div class="line">    pHwConfig-&gt;edmaHwaIn.eventQueue      = DPC_OBJDET_DPU_CFAR_PROC_EDMAIN_EVENT_QUE;</div>
<div class="line">    pHwConfig-&gt;edmaHwaInSignature.channel         = DPC_OBJDET_DPU_CFAR_PROC_EDMAIN_SIG_CH;</div>
<div class="line">    pHwConfig-&gt;edmaHwaInSignature.channelShadow   = DPC_OBJDET_DPU_CFAR_PROC_EDMAIN_SIG_SHADOW;</div>
<div class="line">    pHwConfig-&gt;edmaHwaInSignature.eventQueue      = DPC_OBJDET_DPU_CFAR_PROC_EDMAIN_SIG_EVENT_QUE;</div>
<div class="line">    pHwConfig-&gt;intrObj = &amp;intrObj_cfarProc;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Data Output EDMA */</span></div>
<div class="line">    pHwConfig-&gt;edmaHwaOut.channel         = DPC_OBJDET_DPU_CFAR_PROC_EDMAOUT_RNG_PROFILE_CH;</div>
<div class="line">    pHwConfig-&gt;edmaHwaOut.channelShadow   = DPC_OBJDET_DPU_CFAR_PROC_EDMAOUT_RNG_PROFILE_SHADOW;</div>
<div class="line">    pHwConfig-&gt;edmaHwaOut.eventQueue      = DPC_OBJDET_DPU_CFAR_PROC_EDMAOUT_RNG_PROFILE_EVENT_QUE;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Give M0 and M1 memory banks for detection matrix scratch. */</span></div>
<div class="line">    pHwConfig-&gt;hwaMemInp = (uint16_t *) CSL_APP_HWA_DMA0_RAM_BANK0_BASE;</div>
<div class="line">    pHwConfig-&gt;hwaMemInpSize = (CSL_APP_HWA_BANK_SIZE * 2) / <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* M2 bank: for CFAR detection list */</span></div>
<div class="line">    pHwConfig-&gt;hwaMemOutDetList = (<a class="code" href="structDPU__CFARProcHWA__CfarDetOutput.html">DPU_CFARProcHWA_CfarDetOutput</a> *) CSL_APP_HWA_DMA0_RAM_BANK2_BASE;</div>
<div class="line">    pHwConfig-&gt;hwaMemOutDetListSize = CSL_APP_HWA_BANK_SIZE /</div>
<div class="line">                                <span class="keyword">sizeof</span>(<a class="code" href="structDPU__CFARProcHWA__CfarDetOutput.html">DPU_CFARProcHWA_CfarDetOutput</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* M3 bank: for maximum azimuth values per range bin  (range profile) */</span></div>
<div class="line">    pHwConfig-&gt;hwaMemOutRangeProfile = (<a class="code" href="structDPU__CFARProcHWA__HwaMaxOutput.html">DPU_CFARProcHWA_HwaMaxOutput</a> *) CSL_APP_HWA_DMA0_RAM_BANK3_BASE;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* dynamic config */</span></div>
<div class="line">    cfarProcDpuCfg.dynCfg.cfarCfg   = &amp;gMmwMssMCB.cfarCfg;</div>
<div class="line">    cfarProcDpuCfg.dynCfg.fovRange  = &amp;gMmwMssMCB.rangeSelCfg;</div>
<div class="line">    cfarProcDpuCfg.dynCfg.fovAoaCfg    = &amp;gMmwMssMCB.fovCfg;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* DPU Static config */</span></div>
<div class="line">    params-&gt;detectionHeatmapType = <a class="code" href="cfarproccommon_8h.html#a70e3dad921927a040aeea57599ff35f8">DPU_CFAR_RANGE_AZIMUTH_HEATMAP</a>;</div>
<div class="line">    params-&gt;numRangeBins = gMmwMssMCB.numRangeBins;</div>
<div class="line">    params-&gt;numDopplerBins     = gMmwMssMCB.numDopplerBins;</div>
<div class="line">    params-&gt;log2NumDopplerBins = mathUtils_ceilLog2(params-&gt;numDopplerBins);</div>
<div class="line"> </div>
<div class="line">    params-&gt;selectCoherentPeakInDopplerDim = gMmwMssMCB.sigProcChainCfg.coherentDoppler;</div>
<div class="line">    params-&gt;angleDimension        = gMmwMssMCB.angleDimension;</div>
<div class="line">    params-&gt;isDetMatrixLogScale   = <span class="keyword">false</span>;</div>
<div class="line">    params-&gt;azimuthFftSize        = gMmwMssMCB.sigProcChainCfg.azimuthFftSize;</div>
<div class="line">    params-&gt;elevationFftSize      = gMmwMssMCB.sigProcChainCfg.elevationFftSize;</div>
<div class="line">    params-&gt;isStaticClutterRemovalEnabled = gMmwMssMCB.staticClutterRemovalEnable;</div>
<div class="line"> </div>
<div class="line">    gMmwMssMCB.adcStartTime         = (gMmwMssMCB.profileTimeCfg.h_ChirpAdcStartTime &gt;&gt; 10) * (1/gMmwMssMCB.adcSamplingRate); <span class="comment">//us</span></div>
<div class="line">    adcStart                        =   (gMmwMssMCB.adcStartTime * 1.e-6);</div>
<div class="line">    startFreq                       =   (float)(gMmwMssMCB.startFreq * 1.e9);</div>
<div class="line">    slope                           =   (float)(gMmwMssMCB.chirpSlope * 1.e12);</div>
<div class="line">    bandwidth                       =   (slope * gMmwMssMCB.profileComCfg.h_NumOfAdcSamples)/(gMmwMssMCB.adcSamplingRate * 1.e6);</div>
<div class="line">    centerFreq                      =   startFreq + bandwidth * 0.5f + adcStart * slope;</div>
<div class="line"> </div>
<div class="line">    params-&gt;rangeStep            =   (MMWDEMO_RFPARSER_SPEED_OF_LIGHT_IN_METERS_PER_SEC * (gMmwMssMCB.adcSamplingRate * 1.e6)) /</div>
<div class="line">                                        (2.f * slope * (2*params-&gt;numRangeBins));</div>
<div class="line"> </div>
<div class="line">    gMmwMssMCB.rangeStep           = params-&gt;rangeStep;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (gMmwMssMCB.frameCfg.h_NumOfBurstsInFrame &gt; 1)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Burst mode: h_NumOfBurstsInFrame &gt; 1, h_NumOfChirpsInBurst = 2 */</span></div>
<div class="line">        params-&gt;dopplerStep          =   MMWDEMO_RFPARSER_SPEED_OF_LIGHT_IN_METERS_PER_SEC /</div>
<div class="line">                                            (2.f * params-&gt;numDopplerBins *</div>
<div class="line">                                            centerFreq * (gMmwMssMCB.burstPeriod * 1e-6));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Normal mode: h_NumOfBurstsInFrame = 1, h_NumOfChirpsInBurst &gt;= 2 */</span></div>
<div class="line">        params-&gt;dopplerStep          =   MMWDEMO_RFPARSER_SPEED_OF_LIGHT_IN_METERS_PER_SEC /</div>
<div class="line">                                            (2.f * gMmwMssMCB.frameCfg.h_NumOfChirpsInBurst *</div>
<div class="line">                                            centerFreq * ((gMmwMssMCB.profileTimeCfg.h_ChirpIdleTime + gMmwMssMCB.profileComCfg.h_ChirpRampEndTime) * 1e-1 * 1e-6));</div>
<div class="line">        <span class="keywordflow">if</span>(gMmwMssMCB.frameCfg.c_NumOfChirpsAccum != 0)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">/* When numOfChirpsAccum is greater than zero, the chirping window will increase acccording to numOfChirpsAccum selected. */</span> </div>
<div class="line">            params-&gt;dopplerStep = params-&gt;dopplerStep/gMmwMssMCB.frameCfg.c_NumOfChirpsAccum;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/*outParams-&gt;dopplerResolution    =   MMWDEMO_RFPARSER_SPEED_OF_LIGHT_IN_METERS_PER_SEC /</span></div>
<div class="line"><span class="comment">                                        (2.f * gMmwMssMCB.frameCfg.h_NumOfBurstsInFrame * centerFreq * (gMmwMssMCB.frameCfg.w_BurstPeriodicity));*/</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gMmwMssMCB.antennaGeometryCfg.antDistanceXdim == 0.)</div>
<div class="line">    {</div>
<div class="line">        params-&gt;lambdaOverDistX = 2.0;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        params-&gt;lambdaOverDistX = 3e8 / (centerFreq * gMmwMssMCB.antennaGeometryCfg.antDistanceXdim);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gMmwMssMCB.antennaGeometryCfg.antDistanceZdim == 0.)</div>
<div class="line">    {</div>
<div class="line">        params-&gt;lambdaOverDistZ = 2.0;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        params-&gt;lambdaOverDistZ = 3e8 / (centerFreq * gMmwMssMCB.antennaGeometryCfg.antDistanceZdim);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Range bias (m) */</span></div>
<div class="line">    params-&gt;rangeBias = gMmwMssMCB.compRxChannelBiasCfg.rangeBias;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>(gMmwMssMCB.adcDataSourceCfg.source == 1)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//ADC data from file, populate point cloud list with target indices (range/azimuth/elevation/doppler)</span></div>
<div class="line">        params-&gt;enableCfarPointCloudListWithIndices = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        params-&gt;enableCfarPointCloudListWithIndices = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* hwres config - Copy these structures */</span></div>
<div class="line">    pHwConfig-&gt;dopplerIndexMatrix = gMmwMssMCB.dopplerIndexMatrix;</div>
<div class="line">    pHwConfig-&gt;elevationIndexMatrix = gMmwMssMCB.elevationIndexMatrix;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* For point cloud compression over UART: set the cloud point units and reciprocal values */</span></div>
<div class="line">    gMmwMssMCB.pointCloudToUart.pointUint.xyzUnit = (params-&gt;rangeStep * params-&gt;numRangeBins) / 32768.0;</div>
<div class="line">    gMmwMssMCB.pointCloudToUart.pointUint.dopplerUnit = (params-&gt;dopplerStep * params-&gt;numDopplerBins/2) / 32768.0;</div>
<div class="line">    gMmwMssMCB.pointCloudToUart.pointUint.snrUint = 0.25;</div>
<div class="line">    gMmwMssMCB.pointCloudToUart.pointUint.noiseUint = 1.0;</div>
<div class="line">    gMmwMssMCB.pointCloudUintRecip.xyzUnit = 1. / gMmwMssMCB.pointCloudToUart.pointUint.xyzUnit;</div>
<div class="line">    gMmwMssMCB.pointCloudUintRecip.dopplerUnit = 1. / gMmwMssMCB.pointCloudToUart.pointUint.dopplerUnit;</div>
<div class="line">    gMmwMssMCB.pointCloudUintRecip.snrUint = 1. / gMmwMssMCB.pointCloudToUart.pointUint.snrUint;  <span class="comment">//scale 0.1 since in the CFAR DPU structure it is in 0.1 dB</span></div>
<div class="line">    gMmwMssMCB.pointCloudUintRecip.noiseUint = 1. / gMmwMssMCB.pointCloudToUart.pointUint.noiseUint;  <span class="comment">//scale 0.1 since in the CFAR DPU structure it is in 0.1 dB</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>(gMmwMssMCB.enableMajorMotion)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* In major motion CFAR post processing, the velocity inclusion threshold is set to maximum, so all points are includeed and their detected velocity is not modified */</span></div>
<div class="line">        gMmwMssMCB.cfarRunTimeInputParams[0].forceVelocityToZero = <span class="keyword">false</span>;</div>
<div class="line">        gMmwMssMCB.cfarRunTimeInputParams[0].velocityInclusionThr = params-&gt;dopplerStep * params-&gt;numDopplerBins/2; <span class="comment">//Maximum velocity, include all</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(gMmwMssMCB.enableMinorMotion)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* In minor motion CFAR post processing, the detected points with radial velocity greater than minorMotionVelocityInclusionThr are excluded from the list, </span></div>
<div class="line"><span class="comment">           and then velocity  of included points is forced to zero if the flag forceMinorMotionVelocityToZero is set to true. */</span></div>
<div class="line">        gMmwMssMCB.cfarRunTimeInputParams[1].forceVelocityToZero = gMmwMssMCB.sigProcChainCfg.forceMinorMotionVelocityToZero;</div>
<div class="line">        gMmwMssMCB.cfarRunTimeInputParams[1].velocityInclusionThr = gMmwMssMCB.sigProcChainCfg.minorMotionVelocityInclusionThr;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> DPU Configuration Example </p><div class="fragment"><div class="line">retVal = <a class="code" href="cfarprochwa_8h.html#ac6a6b381612669031d19013e3daca97b">DPU_CFARProcHWA_config</a>(cfarProcDpuHandle, &amp;cfarProcDpuCfg);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (retVal &lt; 0)</div>
<div class="line">{</div>
<div class="line">    CLI_write(<span class="stringliteral">&quot;CFAR DPU config return error:%d \n&quot;</span>, retVal);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p> DPU Process Trigger Example </p><div class="fragment"><div class="line">retVal = <a class="code" href="cfarprochwa_8h.html#ae9e42d4dbc3ca277bb6adcf7bb538eb8">DPU_CFARProcHWA_process</a>(cfarProcDpuHandle,</div>
<div class="line">                                                 &amp;detMatrix[MMW_DEMO_MINOR_MODE],</div>
<div class="line">                                                 &amp;cfarRunTimeInputParams[MMW_DEMO_MINOR_MODE],</div>
<div class="line">                                                 &amp;outParmsCfar);</div>
<div class="line"><span class="keywordflow">if</span>(retVal &lt; 0)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#gafe348ab5badd2c15118f95e21bb192c6">DebugP_log</a>(<span class="stringliteral">&quot;DEBUG: CFAR DPU process return error:%d \n&quot;</span>, retVal);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p> DPU Close Example </p><div class="fragment"><div class="line">retval = <a class="code" href="cfarprochwa_8h.html#a4b2c007a54e46ad583cecdc4d58ab5b8">DPU_CFARProcHWA_deinit</a>(cfarProcDpuHandle);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(retVal &lt; 0)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Not Expected */</span></div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#gafe348ab5badd2c15118f95e21bb192c6">DebugP_log</a>(<span class="stringliteral">&quot;CFARProc DPU deinit error %d\n&quot;</span>, retVal);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --></div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="adoaproc_8h_html_a89ef7b614cfeae7e2b335f9af5d8f649"><div class="ttname"><a href="doaproc_8h.html#a89ef7b614cfeae7e2b335f9af5d8f649">DPU_DOAPROC_MAX_NUM_HWA_PARAMSET</a></div><div class="ttdeci">#define DPU_DOAPROC_MAX_NUM_HWA_PARAMSET</div><div class="ttdoc">Maximum number of HWA paramsets used by DPU.</div><div class="ttdef"><b>Definition:</b> doaproc.h:147</div></div>
<div class="ttc" id="astructDPU__CFARProcHWA__HwaMaxOutput_html"><div class="ttname"><a href="structDPU__CFARProcHWA__HwaMaxOutput.html">DPU_CFARProcHWA_HwaMaxOutput</a></div><div class="ttdoc">Maximum peaks filled by HWA statistics block.</div><div class="ttdef"><b>Definition:</b> cfarprochwa.h:279</div></div>
<div class="ttc" id="acfarprochwa_8h_html"><div class="ttname"><a href="cfarprochwa_8h.html">cfarprochwa.h</a></div><div class="ttdoc">Implements CFARCA DPU using HWA.</div></div>
<div class="ttc" id="astructDPU__CFARProcHWA__Config_html"><div class="ttname"><a href="structDPU__CFARProcHWA__Config.html">DPU_CFARProcHWA_Config</a></div><div class="ttdoc">HWA CFAR configuration.</div><div class="ttdef"><b>Definition:</b> cfarprochwa.h:466</div></div>
<div class="ttc" id="astructDPU__CFARProcHWA__InitParams_html_a9c8fbcbe522ade6a009197984a7b3eec"><div class="ttname"><a href="structDPU__CFARProcHWA__InitParams.html#a9c8fbcbe522ade6a009197984a7b3eec">DPU_CFARProcHWA_InitParams::hwaHandle</a></div><div class="ttdeci">HWA_Handle hwaHandle</div><div class="ttdoc">HWA Handle.</div><div class="ttdef"><b>Definition:</b> cfarprochwa.h:297</div></div>
<div class="ttc" id="astructDPU__CFARProcHWA__CfarDetOutput_html"><div class="ttname"><a href="structDPU__CFARProcHWA__CfarDetOutput.html">DPU_CFARProcHWA_CfarDetOutput</a></div><div class="ttdoc">Detected object parameters filled by HWA CFAR.</div><div class="ttdef"><b>Definition:</b> cfarprochwa.h:264</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__DEBUG_html_gafe348ab5badd2c15118f95e21bb192c6"><div class="ttname"><a href="group__KERNEL__DPL__DEBUG.html#gafe348ab5badd2c15118f95e21bb192c6">DebugP_log</a></div><div class="ttdeci">#define DebugP_log(format,...)</div><div class="ttdoc">Function to log a string to the enabled console.</div><div class="ttdef"><b>Definition:</b> DebugP.h:213</div></div>
<div class="ttc" id="acfarprochwa_8h_html_a6972d9ab611bb1abac276a194d15fc72"><div class="ttname"><a href="cfarprochwa_8h.html#a6972d9ab611bb1abac276a194d15fc72">DPU_CFARPROCHWA_MAX_NUM_HWA_PARAMSET</a></div><div class="ttdeci">#define DPU_CFARPROCHWA_MAX_NUM_HWA_PARAMSET</div><div class="ttdoc">Number HWA params used.</div><div class="ttdef"><b>Definition:</b> cfarprochwa.h:190</div></div>
<div class="ttc" id="astructDPU__CFARProcHWA__InitParams_html"><div class="ttname"><a href="structDPU__CFARProcHWA__InitParams.html">DPU_CFARProcHWA_InitParams</a></div><div class="ttdoc">CFARCAProcHWA DPU initial configuration parameters.</div><div class="ttdef"><b>Definition:</b> cfarprochwa.h:295</div></div>
<div class="ttc" id="acfarprochwa_8h_html_a207bba02593a343aea16e041d90c44a5"><div class="ttname"><a href="cfarprochwa_8h.html#a207bba02593a343aea16e041d90c44a5">DPU_CFARProcHWA_init</a></div><div class="ttdeci">DPU_CFARProcHWA_Handle DPU_CFARProcHWA_init(DPU_CFARProcHWA_InitParams *initCfg, int32_t *errCode)</div></div>
<div class="ttc" id="acfarproccommon_8h_html_a70e3dad921927a040aeea57599ff35f8"><div class="ttname"><a href="cfarproccommon_8h.html#a70e3dad921927a040aeea57599ff35f8">DPU_CFAR_RANGE_AZIMUTH_HEATMAP</a></div><div class="ttdeci">#define DPU_CFAR_RANGE_AZIMUTH_HEATMAP</div><div class="ttdoc">Detection heatmap.</div><div class="ttdef"><b>Definition:</b> cfarproccommon.h:62</div></div>
<div class="ttc" id="arangeprochwa_8h_html_ac725afeda9232deb7624d60a48309e9d"><div class="ttname"><a href="rangeprochwa_8h.html#ac725afeda9232deb7624d60a48309e9d">DPU_RANGEPROCHWA_NUM_HWA_PARAM_SETS</a></div><div class="ttdeci">#define DPU_RANGEPROCHWA_NUM_HWA_PARAM_SETS</div><div class="ttdef"><b>Definition:</b> rangeprochwa.h:79</div></div>
<div class="ttc" id="acfarprochwa_8h_html_ae9e42d4dbc3ca277bb6adcf7bb538eb8"><div class="ttname"><a href="cfarprochwa_8h.html#ae9e42d4dbc3ca277bb6adcf7bb538eb8">DPU_CFARProcHWA_process</a></div><div class="ttdeci">int32_t DPU_CFARProcHWA_process(DPU_CFARProcHWA_Handle handle, DPIF_DetMatrix *detMatrix, DPU_CFARProcHWA_InputParams *inputParams, DPU_CFARProcHWA_OutParams *outParams)</div></div>
<div class="ttc" id="acfarprochwa_8h_html_a4b2c007a54e46ad583cecdc4d58ab5b8"><div class="ttname"><a href="cfarprochwa_8h.html#a4b2c007a54e46ad583cecdc4d58ab5b8">DPU_CFARProcHWA_deinit</a></div><div class="ttdeci">int32_t DPU_CFARProcHWA_deinit(DPU_CFARProcHWA_Handle handle)</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__DEBUG_html_ga552e9055ca7eab5fe6c224c6cd5a9d4c"><div class="ttname"><a href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a></div><div class="ttdeci">#define DebugP_assert(expression)</div><div class="ttdoc">Function to call for assert check.</div><div class="ttdef"><b>Definition:</b> DebugP.h:159</div></div>
<div class="ttc" id="acfarprochwa_8h_html_ac6a6b381612669031d19013e3daca97b"><div class="ttname"><a href="cfarprochwa_8h.html#ac6a6b381612669031d19013e3daca97b">DPU_CFARProcHWA_config</a></div><div class="ttdeci">int32_t DPU_CFARProcHWA_config(DPU_CFARProcHWA_Handle handle, DPU_CFARProcHWA_Config *cfarHwaCfg)</div></div>
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
