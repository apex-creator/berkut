<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>xWRL1432 MMWAVE-L-SDK: Shared Memory Usage</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="xWRL1432 MMWAVE-L-SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">xWRL1432 MMWAVE-L-SDK
   &#160;<span id="projectnumber">05.05.04.02</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('SHARED_MEMORY.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Shared Memory Usage </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md638">Introduction</a></li>
<li class="level1"><a href="#EXAMPLES_DRIVERS_SHM_COMBOS">Supported Combinations</a></li>
<li class="level1"><a href="#autotoc_md639">Using SDK with SysConfig</a></li>
<li class="level1"><a href="#autotoc_md640">Steps to Run the Example</a></li>
<li class="level1"><a href="#autotoc_md641">Sample Output</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_drivers_shared_memory"></a></p>
<h1><a class="anchor" id="autotoc_md638"></a>
Introduction</h1>
<p>xWRL1432 has 512KB Shared Memory in following configurations: <br  />
</p><ul>
<li>
256KB between HWASS and APPSS<br  />
</li>
<li>
96KB between HWASS and FECSS <br  />
</li>
<li>
160KB dedicated to HWASS. <br  />
</li>
</ul>
<p>This example shows the usage of 256KB HWASS/APPSS Shared memory as APPSS memory and usage of 160KB HWASS dedicated Memory plus 96KB of HWA/FECSS (configured for HWASS by default) shared memory in APPSS software (helpful in cases when complete 160KB + 96KB memory is not used for HWA). Following registers will help in configuring 256KB Memory between APPSS and HWASS (Refer to Technical Reference Manual for more details): <br  />
 </p><ul>
<li>
TOP_PRCM:HWA_PD_MEM_SHARE_REG <br  />
</li>
<li>
<p class="startli">APP_CTRL:APPSS_SHARED_MEM_CLK_GATE &lt;/ul <br  />
<br  />
 When running in functional mode RBL can be leveraged to perform these configurations. This can be done through modifying "SH_MEM_CONFIG" macro found in build files ("makefile" , "makefile_ccs_bootimage_gen"). The following configurations are possible: <br  />
</p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><b>SH_MEM_CONFIG VALUE</b>  </th><th class="markdownTableHeadNone"><b>TOTAL APPSS RAM (INCL. SHARED RAM)</b>  </th><th class="markdownTableHeadNone"><b>HWASS (FECSS shared Memory to be taken care by HWASS)</b>   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SH_MEM_CONFIG=0  </td><td class="markdownTableBodyNone">0x00400000 - 0x0047FFFF (512 KB)  </td><td class="markdownTableBodyNone">0x60000000 - 0x6007FFFF (512 KB)   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SH_MEM_CONFIG=1  </td><td class="markdownTableBodyNone">0x00400000 - 0x0049FFFF (640 KB)  </td><td class="markdownTableBodyNone">0x60000000 - 0x6005FFFF (384 KB)   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SH_MEM_CONFIG=2  </td><td class="markdownTableBodyNone">0x00400000 - 0x0047FFFF<br  />
0x004A0000 - 0x004BFFFF <br  />
 (640KB)  </td><td class="markdownTableBodyNone">0x60000000 - 0x6005FFFF (384 KB)   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SH_MEM_CONFIG=3  </td><td class="markdownTableBodyNone">0x00400000 - 0x004BFFFF (768 KB)  </td><td class="markdownTableBodyNone">0x60000000 - 0x6003FFFF (256 KB)   </td></tr>
</table>
<p class="interli"><br  />
 In case complete HWASS Memory is not used, that memory can be used for APPSS Software. However as this memory is not initialized by RBL, application has to ensure that this memory is intitialized before use. Hence we cannot use it for .text, .data, .ro sections. This example demonstrates one such use case. <br  />
 .text file is being assigned to the M4F_SHRM section in the linker file <br  />
 Shared Memory Demonstration: <br  />
 <style>div.image img[src="shared_mem.png"]{width:50%}</style> </p><div class="image">
<img src="shared_mem.png" alt=""/>
</div>
<p class="interli"><br  />
<br  />
 To configure <b>FECSS/HWA Shared Memory (96KB)</b> for HWASS(Configured for HWASS by default), Following registers have to be configured (Refer to Technical Reference Manual for more details): <br  />
TOP_PRCM:HWA_PD_MEM_SHARE_REG <br  />
FEC_CTRL:FECSS_SHARED_MEM_CLK_GATE<br  />
 When this memory is configured for HWASS the address range is in continuation to HWASS (160KB) Memory. <br  />
<br  />
 The .l3 section is assigned to the start of the HWASS dedicated memory space in the linker file. The array created spans more than the 160 KB forcing allocation into the FECSS shared memory area. This example writes 0xFF to these memory locations.<br  />
<br  />
 <b>Important Notes:</b> When shared memory is allocated to M4/M3, back to back full word write access to a location followed by sub-word write access to another location corrupts data in previously written location. Refer to Errata Dig#14 "Corrupted Data Store for Partial Write in Shared Memory" in Errata document. Workarounds:</p><ol type="1">
<li>Disable ECC for non functional safety devices â€“ ECC is disabled for shared memories in RBL for non functional safety devices.</li>
<li>Use shared memories as code memory "only" when shared with M3/M4 processor. <br  />
Though this examples demonstrates the use of shared memory for data section etc. precautions mentioned above must be taken care of.</li>
</ol>
<p class="endli"></p>
</li>
</ul>
<h1><a class="anchor" id="EXAMPLES_DRIVERS_SHM_COMBOS"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU + OS  </td><td class="markdownTableBodyNone">m4fss0-0 freertos   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">ti-arm-clang   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Boards  </td><td class="markdownTableBodyNone">xWRL1432-evm   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/drivers/sharedmemory   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md639"></a>
Using SDK with SysConfig</h1>
<p>A GUI tool SysConfig is used to configure different modules and peripherals of the example. Using this tool, users can select and customize different modules and peripherals. The SysConfig tool will generate the code for initializing and configuring these modules. This configuration is saved to a file called example.syscfg for every example. To know more about how to use SDK with SysConfig, Visit this page</p>
<p><a class="el" href="SYSCONFIG_INTRO_PAGE.html">Using SDK with SysConfig</a></p>
<h1><a class="anchor" id="autotoc_md640"></a>
Steps to Run the Example</h1>
<ul>
<li><b>When using CCS projects to build</b>, import the CCS project for the required combination and build it using the CCS project menu (see <a class="el" href="CCS_PROJECTS_PAGE.html">Using SDK with CCS Projects</a>).</li>
<li><b>When using makefiles to build</b>, note the required combination and build using make command (see <a class="el" href="MAKEFILE_BUILD_PAGE.html">Using SDK with Makefiles</a>).</li>
<li><b>Important Notes:</b> <ul>
<li>
As this example is designed to run from APPSS-HWASS 256KB shared memory, following configurations are needed prior to running it. </li>
<li>
<b>Make sure to confirm that the Region Size of CONFIG_MPU_REGION1 is set to 1MB in example.syscfg</b> </li>
</ul>
 <style>div.image img[src="syscfg-sharedmem.png"]{width:35%}</style> <div class="image">
<img src="syscfg-sharedmem.png" alt=""/>
</div>
 <ul>
<li>
If we want this example to run from flash in functional mode, this example (sharedmemory.xxx.appimage) can be flashed using visualizer tool (<a class="el" href="TOOLS_VISUALIZER.html">Visualizer Tool</a>) or UniFlash tool </li>
<li>
If we want to use CCS to run this example as per <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a>, following changes have to be made in empty project and empty project has to be rebuilt before using it: <br  />
<ul>
<li>Modify "SH_MEM_CONFIG" to "0x3" in "makefile" and "makefile_ccs_bootimage_gen" files of empty project.</li>
<li>Ensure the MPU configuration in Sys config of empty project for RAM is of 1MB size. </li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md641"></a>
Sample Output</h1>
<p>Shown below is a sample output when the application is run,</p>
<div class="fragment"><div class="line">*************Accessing Data Section stored in APPSS SHARED RAM *************</div>
<div class="line"> </div>
<div class="line">Initial value of test_var1 (APPSS Shared RAM) is 1 </div>
<div class="line">updating value of test_var1 (APPSS Shared RAM) to 10 </div>
<div class="line">value of test_var1 (APPSS Shared RAM) is 10 </div>
<div class="line"> </div>
<div class="line">Initial value of test_var2 (APPSS Shared RAM) is 2 </div>
<div class="line">updating value of test_var2 (APPSS Shared RAM) to 20 </div>
<div class="line">value of test_var2 (APPSS Shared RAM) is 20 </div>
<div class="line"> </div>
<div class="line">*************Accessing Variables stored in HWASS SHARED RAM *************</div>
<div class="line"> </div>
<div class="line">value of testhwameml3[0] (HWA) is 255 </div>
<div class="line"> </div>
<div class="line">value of testhwameml3[1] (HWA)is 255 </div>
<div class="line"> </div>
<div class="line">*************Accessing Variables stored in FECSS SHARED RAM *************</div>
<div class="line"> </div>
<div class="line">value of testhwameml3[163900] (FECSS) is 255 </div>
<div class="line"> </div>
<div class="line">value of testhwameml3[163901] (FECSS)is 255 </div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
